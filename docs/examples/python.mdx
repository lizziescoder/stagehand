---
title: Stagehand in Python
description: Python is a popular language for automation, data extraction, and AI applications. Stagehand provides a Python SDK that brings the power of AI-driven browser automation to Python developers.
---

<Tip>
We'll be using the [Browserbase SDK](https://docs.browserbase.com/reference/sdk) for our browser. Running Stagehand without Browserbase is very difficult, since it requires a browser instance to be running.
</Tip>

<Card
  title="Check out the Stagehand Python Examples"
  icon="github"
  href="https://github.com/browserbase/stagehand-python-examples"
>
  Clone our [GitHub repo](https://github.com/browserbase/stagehand-python-examples) to get started with Stagehand in Python.
</Card>

## Installation

Install the Stagehand Python SDK:

<Tabs>
	<Tab title="pip">
	```bash
	pip install stagehand
	```
	</Tab>

	<Tab title="poetry">
	```bash
	poetry add stagehand
	```
	</Tab>

	<Tab title="conda">
	```bash
	conda install -c conda-forge stagehand
	```
	</Tab>
</Tabs>

## Environment Setup

Set up your environment variables in a `.env` file or export them in your shell:

```bash
export BROWSERBASE_API_KEY="your_browserbase_api_key"
export BROWSERBASE_PROJECT_ID="your_browserbase_project_id"
export MODEL_API_KEY="your_model_api_key"  # OpenAI, Anthropic, Google, etc.
export STAGEHAND_API_URL=https://api.stagehand.browserbase.com/v1 # Stagehand API URL
```

## Basic Example

Here's a basic example showing how to use Stagehand Python SDK:

```python example.py
import asyncio
import os
from stagehand import Stagehand, StagehandConfig
from dotenv import load_dotenv

load_dotenv()

async def main():
    """
    Basic example of using Stagehand Python SDK
    """
    # Initialize Stagehand with configuration
    config = StagehandConfig(
        env="BROWSERBASE",
        api_key=os.getenv("BROWSERBASE_API_KEY"),
        project_id=os.getenv("BROWSERBASE_PROJECT_ID"),
        headless=True,
        verbose=1,
        model_name="gpt-4o",
        model_client_options={"apiKey": os.getenv("MODEL_API_KEY")}
    )
    
    # Create Stagehand instance
    stagehand = Stagehand(config)
    
    try:
        # Initialize the browser session
        await stagehand.init()
        
        # Get the page object (similar to Playwright's page)
        page = stagehand.page
        
        # Navigate to a website
        await page.goto("https://docs.stagehand.dev/")
        
        # Use AI to click on elements using natural language
        await page.act("click the quickstart link")
        
        # Extract data from the page
        result = await page.extract("extract the main heading of the page")
        
        print(f"Extracted title: {result}")
        
        # Observe elements on the page (useful for planning actions)
        observations = await page.observe("find all navigation links")
        print(f"Found {len(observations)} navigation elements")
        
    finally:
        # Always close the session
        await stagehand.close()

if __name__ == "__main__":
    asyncio.run(main())
```

## Using Structured Extraction

For more structured data extraction, you can use Pydantic models:

```python structured_example.py
import asyncio
import os
from pydantic import BaseModel, Field
from stagehand import Stagehand, StagehandConfig, ExtractOptions
from dotenv import load_dotenv

load_dotenv()

class Article(BaseModel):
    title: str = Field(..., description="The title of the article")
    summary: str = Field(..., description="A brief summary of the article")

class ArticleList(BaseModel):
    articles: list[Article] = Field(..., description="List of articles on the page")

async def main():
    config = StagehandConfig(
        env="BROWSERBASE",
        api_key=os.getenv("BROWSERBASE_API_KEY"),
        project_id=os.getenv("BROWSERBASE_PROJECT_ID"),
        model_name="gpt-4o",
        model_client_options={"apiKey": os.getenv("MODEL_API_KEY")}
    )
    
    stagehand = Stagehand(config)
    
    try:
        await stagehand.init()
        page = stagehand.page
        
        await page.goto("https://news.ycombinator.com")
        
        # Extract structured data using Pydantic models
        extract_options = ExtractOptions(
            instruction="Extract the top 5 articles from the front page",
            schema_definition=ArticleList
        )
        
        result = await page.extract(extract_options)
        
        if hasattr(result, 'articles'):
            for i, article in enumerate(result.articles, 1):
                print(f"{i}. {article.title}")
                print(f"   Summary: {article.summary}\n")
        
    finally:
        await stagehand.close()

if __name__ == "__main__":
    asyncio.run(main())
```

## Using the Agent

For more complex tasks, you can use Stagehand's Agent functionality that can autonomously execute larger workflows:

```python agent_example.py
import asyncio
import logging
import os
from stagehand import Stagehand, StagehandConfig, configure_logging
from browserbase.types import SessionCreateParams as BrowserbaseSessionCreateParams
from dotenv import load_dotenv

load_dotenv()

# Configure logging
configure_logging(
    level=logging.INFO,
    quiet_dependencies=True,
)

browserbase_session_create_params = BrowserbaseSessionCreateParams(
        project_id=os.getenv("BROWSERBASE_PROJECT_ID"),
        proxies=True,
    )

async def main():
    """
    Example using Stagehand Agent for autonomous task execution
    """
    config = StagehandConfig(
        env="BROWSERBASE",
        api_key=os.getenv("BROWSERBASE_API_KEY"),
        project_id=os.getenv("BROWSERBASE_PROJECT_ID"),
        browserbase_session_create_params=browserbase_session_create_params,
        headless=False,  # Set to False to see the browser in action
        verbose=2,
        model_name="gpt-4o",
        self_heal=True,
        system_prompt="You are a browser automation assistant that helps users navigate websites effectively.",
        model_client_options={"apiKey": os.getenv("MODEL_API_KEY")}
    )
    
    stagehand = Stagehand(config)
    
    try:
        await stagehand.init()
        
        # Navigate to a starting page
        await stagehand.page.goto("https://www.google.com")
        
        # Create an agent with custom instructions
        agent = stagehand.agent(
            model="computer-use-preview",
            instructions="You are a helpful assistant that can browse the web. Be thorough in your research and provide detailed information.",
            options={"apiKey": os.getenv("MODEL_API_KEY")}
        )
        
        # Execute a complex task autonomously
        result = await agent.execute(
            instruction="Search for the latest news about AI developments in 2024 and summarize the top 3 stories",
            max_steps=20,
            auto_screenshot=True
        )
        
        print("Agent result:")
        print(f"Success: {result.success}")
        print(f"Completed: {result.completed}")
        print(f"Message: {result.message}")
        print(f"Actions performed: {len(result.actions) if result.actions else 0}")
        
        if result.actions:
            for i, action in enumerate(result.actions):
                print(f"  Action {i+1}: {action.get('type', 'Unknown')} - {action.get('description', 'No description')}")
        
    finally:
        await stagehand.close()

if __name__ == "__main__":
    asyncio.run(main())
```

## Agent with Computer Use

You can also use Computer Use models for more advanced automation:

```python computer_use_example.py
import asyncio
import os
from stagehand import Stagehand, StagehandConfig
from dotenv import load_dotenv

load_dotenv()

async def main():
    config = StagehandConfig(
        env="BROWSERBASE",
        api_key=os.getenv("BROWSERBASE_API_KEY"),
        project_id=os.getenv("BROWSERBASE_PROJECT_ID"),
        model_name="computer-use-preview",
        model_client_options={"apiKey": os.getenv("MODEL_API_KEY")}
    )
    
    stagehand = Stagehand(config)
    
    try:
        await stagehand.init()
        
        await stagehand.page.goto("https://news.ycombinator.com")
        
        # Create and use an agent with Computer Use
        agent = stagehand.agent(
            model="computer-use-preview",
            instructions="You are a research assistant specialized in technology news. Focus on finding the most relevant and recent information.",
            options={"apiKey": os.getenv("MODEL_API_KEY")}
        )
        
        # Execute a research task
        result = await agent.execute(
            instruction="Find the top 5 most popular posts on this page and summarize what they're about",
            max_steps=15,
            auto_screenshot=True
        )
        
        print("Research results:")
        print(result.message)
        
    finally:
        await stagehand.close()

if __name__ == "__main__":
    main()
```

## Configuration Options

The `StagehandConfig` class provides various options to customize behavior:

```python
from stagehand import StagehandConfig

config = StagehandConfig(
    # Environment and API configuration
    env="BROWSERBASE",  # or "LOCAL" for local browser
    api_key="your_browserbase_api_key",
    project_id="your_browserbase_project_id",
    
    # Browser settings
    headless=True,  # Run browser in headless mode
    
    # Model configuration
    model_name="gpt-4o",
    model_client_options={"apiKey": "your_model_api_key"},
    
    # Timing and behavior
    dom_settle_timeout_ms=5000,  # Wait for DOM to settle
    verbose=1,  # Logging level (0-3)
    
    # Advanced options
    self_heal=True,  # Attempt to recover from errors
    wait_for_captcha_solves=True,  # Wait for captcha solving
    system_prompt="Custom system prompt for the AI",
)
```

## Error Handling

Always implement proper error handling in your Python scripts:

```python
import asyncio
from stagehand import Stagehand, StagehandConfig

async def robust_automation():
    stagehand = None
    try:
        config = StagehandConfig(
            env="BROWSERBASE",
            api_key=os.getenv("BROWSERBASE_API_KEY"),
            project_id=os.getenv("BROWSERBASE_PROJECT_ID"),
            model_name="gpt-4o",
            model_client_options={"apiKey": os.getenv("MODEL_API_KEY")}
        )
        
        stagehand = Stagehand(config)
        await stagehand.init()
        
        # Your automation code here
        await stagehand.page.goto("https://example.com")
        await stagehand.page.act("click the login button")
        
    except Exception as e:
        print(f"Error: {e}")
    finally:
        if stagehand:
            await stagehand.close()

asyncio.run(robust_automation())
```

## Integration with Data Science Workflows

Stagehand Python SDK integrates well with popular data science libraries:

```python
import pandas as pd
from stagehand import Stagehand, StagehandConfig, ExtractOptions
from pydantic import BaseModel, Field

class Product(BaseModel):
    name: str = Field(..., description="Product name")
    price: str = Field(..., description="Product price")
    rating: float = Field(..., description="Product rating")

class ProductList(BaseModel):
    products: list[Product] = Field(..., description="List of products")

async def scrape_to_dataframe():
    """
    Example of scraping data and converting to pandas DataFrame
    """
    config = StagehandConfig(
        env="BROWSERBASE",
        api_key=os.getenv("BROWSERBASE_API_KEY"),
        project_id=os.getenv("BROWSERBASE_PROJECT_ID"),
        model_name="gpt-4o",
        model_client_options={"apiKey": os.getenv("MODEL_API_KEY")}
    )
    
    stagehand = Stagehand(config)
    
    try:
        await stagehand.init()
        await stagehand.page.goto("https://example-ecommerce.com/products")
        
        # Extract structured product data
        extract_options = ExtractOptions(
            instruction="extract all products with their names, prices, and ratings",
            schema_definition=ProductList
        )
        
        result = await stagehand.page.extract(extract_options)
        
        # Convert to pandas DataFrame
        if hasattr(result, 'products'):
            df = pd.DataFrame([product.model_dump() for product in result.products])
            return df
        
    finally:
        await stagehand.close()

# Usage
df = await scrape_to_dataframe()
print(df.head())
print(f"\nTotal products: {len(df)}")
print(f"Average rating: {df['rating'].mean():.2f}")
```

## Next Steps

- Explore the [GitHub examples repository](https://github.com/browserbase/stagehand-python-examples) for more code samples
- Check out the [CrewAI integration](/integrations/crew-ai) for AI agent workflows
- Learn about [caching strategies](/examples/caching) to optimize performance
- Review [best practices](/examples/best_practices) for production usage

## Additional Resources

- [Stagehand Python SDK GitHub Repository](https://github.com/browserbase/stagehand-python)
- [Browserbase Documentation](https://docs.browserbase.com)
- Join the [Stagehand Slack community](https://stagehand.dev/slack) for support and community discussions 